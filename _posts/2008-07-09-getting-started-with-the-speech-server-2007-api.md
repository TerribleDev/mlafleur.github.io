---
Title: >
  Getting Started with the Speech Server
  2007 API
Excerpt: ""
Tags:
  - Skype
---
<p>Speech Server 2007 has a really cool Windows Workflow based programming model that lets you quickly build interactive voice response applications. For many applications it is all you will ever need.</p>  <p>Sometimes however you find the workflow model just isn't the right fit. If you're looking for really fine-grained control over the application, or you simply prefer to work in code, then the Core API is what you need. </p>  <p>Unfortunately figuring out you want to use the API is a lot easier than figuring out how to start using it. There is very little documentation and no Visual Studio project templates or samples included with Speech Server. </p>  <p>I'll do my best to give a brick-simple explanation of how to get your first core API project started. You can also <a href="http://www.massivescale.com/sample_code/VoiceResponseWorkflowApplication1.zip" target="_blank">download the zipped project</a> files.</p>  <p>1) First you'll need to create a new Voice Response Workflow Application. We'll use the project that gets generated as our foundation.</p>  <p><a href="http://weblogs.asp.net/blogs/mlafleur/WindowsLiveWriter/GettingStartedwiththeSpeechServer2007API_C5D2/image_2.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="174" alt="image" src="http://weblogs.asp.net/blogs/mlafleur/WindowsLiveWriter/GettingStartedwiththeSpeechServer2007API_C5D2/image_thumb.png" width="244" border="0" /></a></p>  <p>2) When asked for the application resources you'll want to uncheck everything. </p>  <p><a href="http://weblogs.asp.net/blogs/mlafleur/WindowsLiveWriter/GettingStartedwiththeSpeechServer2007API_C5D2/image_4.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="244" alt="image" src="http://weblogs.asp.net/blogs/mlafleur/WindowsLiveWriter/GettingStartedwiththeSpeechServer2007API_C5D2/image_thumb_1.png" width="210" border="0" /></a></p>  <p>3) Open up the Class1.cs file and remove all of the references to the VoiceResponseWorkflow1 class. The resulting class should look like the following (I removed the comments in the code for brevity):</p>  <p><font face="Courier New">using System;     <br />using System.Collections.Generic;      <br />using System.Text;      <br />using Microsoft.SpeechServer ;      <br />using Microsoft.SpeechServer.Dialog; </font></p>  <p><font face="Courier New">namespace VoiceResponseWorkflowApplication1     <br />{      <br />&#160;&#160;&#160; public class Class1 : IHostedSpeechApplication      <br />&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; private IApplicationHost _host; </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void Start(IApplicationHost host)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (host != null)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host = host;      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.CurrentUICulture = System.Globalization.CultureInfo.GetCultureInfo(&quot;en-US&quot;);      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new ArgumentNullException(&quot;host&quot;);      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void Stop(bool immediate)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void OnUnhandledException(Exception exception)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (exception != null)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.LoggingManager.LogApplicationError(100, &quot;An unexpected exception occurred: {0}&quot;, exception.Message);      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.LoggingManager.LogApplicationError(100, &quot;An unknown exception occurred: {0}&quot;, System.Environment.StackTrace);      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.OnCompleted();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }      <br />&#160;&#160;&#160; }      <br />}</font></p>  <p>That's all folks. Class1.cs is now the starting point of your Core API application. As a further example, lets take the project and add some code to turn it into an outbound dialing &quot;Hello World&quot; application.</p>  <p><font face="Courier New">using System;      <br />using System.Collections.Generic;       <br />using System.Text;       <br />using Microsoft.SpeechServer ;       <br />using Microsoft.SpeechServer.Dialog; </font></p>  <p><font face="Courier New">namespace VoiceResponseWorkflowApplication1      <br />{       <br />&#160;&#160;&#160; public class Class1 : IHostedSpeechApplication       <br />&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; private IApplicationHost _host; </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void Start(IApplicationHost host)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (host != null)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host = host;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.CurrentUICulture = System.Globalization.CultureInfo.GetCultureInfo(&quot;en-US&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Dial and outbound call (make sure you change these numbers :-)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.OpenCompleted += new EventHandler&lt;AsyncCompletedEventArgs&gt;(TelephonySession_OpenCompleted);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.OpenAsync(&quot;7813062200&quot;, &quot;8887006263&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new ArgumentNullException(&quot;host&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; void TelephonySession_OpenCompleted(object sender, AsyncCompletedEventArgs e)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (e.Error != null)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.Close();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.Synthesizer.SpeakCompleted += new EventHandler&lt;Microsoft.SpeechServer.Synthesis.SpeakCompletedEventArgs&gt;(Synthesizer_SpeakCompleted);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.Synthesizer.SpeakAsync(&quot;Hello World&quot;, Microsoft.SpeechServer.Synthesis.SynthesisTextFormat.PlainText);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; void Synthesizer_SpeakCompleted(object sender, Microsoft.SpeechServer.Synthesis.SpeakCompletedEventArgs e)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.Close();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void Stop(bool immediate)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; public void OnUnhandledException(Exception exception)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (exception != null)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.LoggingManager.LogApplicationError(100, &quot;An unexpected exception occurred: {0}&quot;, exception.Message);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.TelephonySession.LoggingManager.LogApplicationError(100, &quot;An unknown exception occurred: {0}&quot;, System.Environment.StackTrace);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></p>  <p><font face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _host.OnCompleted();      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160; }       <br />}</font></p>  <p>(<a href="http://www.massivescale.com/sample_code/VoiceResponseWorkflowApplication1.zip" target="_blank">download the zipped project</a>)</p>